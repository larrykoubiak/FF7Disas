<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<title>FF7/Field/DialogWindow - QhimmWiki</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.20.2" />
<link rel="shortcut icon" href="http://wiki.qhimm.com/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.qhimm.com/opensearch_desc.php" title="QhimmWiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.qhimm.com/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/2.5/" />
<link rel="alternate" type="application/atom+xml" title="QhimmWiki Atom feed" href="http://wiki.qhimm.com/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="../../../load.php@debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;%252A.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: qhimm_wiki:resourceloader:filter:minify-css:7:9f75cd7a214f5d1850ed6d0df1a4a089 */</style>

<script src="../../../load.php@debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;%252A"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"FF7/Field/DialogWindow","wgTitle":"FF7/Field/DialogWindow","wgCurRevisionId":4169,"wgArticleId":1335,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"FF7/Field/DialogWindow","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,
"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","watchToken":false});;},{},{});
/* cache key: qhimm_wiki:resourceloader:filter:minify-js:7:7330ebaa3a8da3f7992caf476ddb8efd */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-FF7_Field_DialogWindow skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content" class="mw-body">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading"><span dir="auto">FF7/Field/DialogWindow</span></h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
								<!-- tagline -->
				<div id="siteSub">From QhimmWiki</div>
				<!-- /tagline -->
								<!-- subtitle -->
				<div id="contentSub"><span class="subpages">&lt; <a href="../../FF7.html" title="FF7">FF7</a>&lrm; | <a href="../Field.1.html" title="FF7/Field">Field</a></span></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="DialogWindow.html#mw-head">navigation</a>, 					<a href="DialogWindow.html#p-search">search</a>
				</div>
				<!-- /jumpto -->
								<!-- bodycontent -->
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="DialogWindow.html#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="DialogWindow.html#Memory_Layout"><span class="tocnumber">2</span> <span class="toctext">Memory Layout</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="DialogWindow.html#State"><span class="tocnumber">3</span> <span class="toctext">State</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="DialogWindow.html#Functions"><span class="tocnumber">4</span> <span class="toctext">Functions</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="DialogWindow.html#Opcodes"><span class="tocnumber">5</span> <span class="toctext">Opcodes</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="DialogWindow.html#Special_Letters"><span class="tocnumber">6</span> <span class="toctext">Special Letters</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Description"> Description </span></h2>
<p>Field module of Final Fantasy VII han handle 4 dialog windows at once. All data for them stored in structures with size 0x30.
There are a lot of additional arrays used for variables offsets and many other data used by windows.
</p><p>All windows can be called any time with 0x40 MESSAGE or 0x48 ASK opcodes. They will be called all the time, when window is shown on screen. Only after window is closed this opcode will be skipped and script pointer go to next opcode.
There are a lot of window parameters opcode. they are set different parameters to window. They are 0x2E WCLS 0x2F WSIZW 0x36 WSPCL 0x37 WNUMB 0x38 STTIM 0x41 MPARA 0x42 MPRA2 0x50 WINDOW 0x51 WMOVE 0x52 WMODE 0x53 WREST 0x55 WROW 0x57 SWCOL. All of them write parameters directly to structure, but they need to be called from the same entity else they wait till the window is closed.
</p><p>Window is state driven. The way how window handling input and shown are dependent on state. State handling called by MESSAGE and ASK opcode. State handling of this two opcodes a bit different. By default window state is zero (closed window).
</p>
<h2> <span class="mw-headline" id="Memory_Layout"> Memory Layout </span></h2>
<p>This is offsets to english version of game. But japanese has exactly same structure, just offsets a bit different. this is all offsets used by dialog windows (opcode reading offsets not included here).
</p><p>800491D0 character id -&gt; savemap block assosiation id. (0-0, 1-1, 2-2, 3-3, 4-4, 5-5, 6-6, 7-7, 8-8, 9-6, A-7)
</p><p>80049208 window RGB. (size [r][g][b]x4)
</p><p>80071E2C number of opened windows. Increment this during window initialization. Decrement during closing.
</p><p>8007E7A8 offset to dialog block.
</p><p>8008326C []       windows parent entity (size 0x01).
</p><p>80083274 [][][][] windows data (size 0x30). Pointer to dialog string.
</p><p>80083278 [][]     windows data (size 0x30). WINDOW x.
</p><p>8008327A [][]     windows data (size 0x30). WINDOW y.
</p><p>8008327C [][]     windows data (size 0x30). WINDOW width.
</p><p>8008327E [][]     windows data (size 0x30). WINDOW height.
</p><p>80083280 [][]     windows data (size 0x30). WINDOW current width. Set during dialog init (width / 4) (8 - min value).
</p><p>80083282 [][]     windows data (size 0x30). WINDOW current height. Set during dialog init (height / 
4) (8 - min value).
</p><p>80083284 [][]     windows data (size 0x30). Text scrolling value.
</p><p>80083286 [][]     windows data (size 0x30). Letters in window string.
</p><p>80083288 [][]     windows data (size 0x30). Bytes in window string.
</p><p>8008328A [][]     windows data (size 0x30). Current row in string. Incremented during copy.
</p><p>8008328D []       windows data (size 0x30). WMODE style.
</p><p>8008328E []       windows data (size 0x30). Show pointer.
</p><p>8008328F []       windows data (size 0x30). WSPCL type.
</p><p>80083291 []       windows data (size 0x30). WNUMB number of digits in number.
</p><p>80083294 [][][][] windows data (size 0x30). WNUMB number.
</p><p>80083298 [][]     windows data (size 0x30). Pointer X.
</p><p>8008329A [][]     windows data (size 0x30). Pointer Y.
</p><p>8008329C []       windows data (size 0x30). WSPCL x.
</p><p>8008329E []       windows data (size 0x30). WSPCL y.
</p><p>800832A0 [][]     windows data (size 0x30). window state.
</p><p>800832A2 []       windows data (size 0x30). WMODE cbc.
</p><p>8009C6E4 savemap start
</p><p>8009C748          savemap character name data (Cloud).
</p><p>8009D268 [][][][] savemap seconds for timer (set in STTIM).
</p><p>8009D288 savemap memory bank 1/2 start
</p><p>8009D391 [][][]   savemap party info.
</p><p>8009D7D0 []       savemap message speed.
</p><p>800E0738 digit-&gt;letter assosiation array (10-26 letters from character table)
</p><p>800E4214 memory bank array for getting variable for windows. 8 for each window. (size 0x8 0x1)
</p><p>800E4234 reading offsets in dialog in field. One for each window. (size 0x4).
</p><p>800E424C total window height. Height of window with extra rows. Set this during B state in window as 8008328A (current row) * 10 + 11. (size 0x2).
</p><p>800E4278 [][] name reading offset for dialog windows. (size 0x2).
</p><p>800E4280 [][] current variable for windows. (size 0x2).
</p><p>800E4944 text for windows to diaplay. (size 0x100)
</p><p>800E4D48 offsets for getting variable from memory block for windows. 8 for each window. (size 0x10 0x2)
</p><p>80114278 [][] some data for windows. Set this to zero during window initialization
</p><p>801142CC [][] additional rows during text scrolling. (size 0x2).
</p><p>8011445C [][] time to wait for windows. (size 0x2).
</p><p>80114470 [][] field dialog value which content value how mush characters add at current character copy. (size 0x08 0x2).
</p><p>80114480 [][] field dialog OK button speed modificator. (size 0x08 0x2).
</p><p>801144DC [][] temp variable string. First we write variable here and then copy it to window string. (size 0x10).
</p><p>8011451C [][] current variable read offset. (size 0x2).
</p><p><br />
</p>
<h2> <span class="mw-headline" id="State"> State </span></h2>
<p>0 - init window.
</p><p>1 - window appears.
</p><p>2 - text appears.
</p><p>3 - pause string output. (next part of sting will be added to outputed string after time).
</p><p>4 - wait for next row (next row of text will show after OK button).
</p><p>5
</p><p>6 - window completly shown (window will close after OK button press).
</p><p>7 - window closing.
</p><p>8 - scroll to next row.
</p><p>9 - init next window.
</p><p>A
</p><p>B - pause string output. (text will be scrolled to next window while you hold OK button).
</p><p>C - scroll to next row during OK button press.
</p><p>D - pause string output. (next part of sting will be added to outputed string after OK button).
</p><p>E - wait for next window (next block of text will show after this). Opcodes 0xE8 0xE9.
</p><p><br />
</p><p>message window states:
</p><p>state 0: call "dialog_window_init".
</p><p>state 1: call "dialog_window_growth".
</p><p>state 2: call "dialog_copy_text_from_field".
</p><p>state 3: discrease 8011445C (wait time) by 1 each call. When wait time == 0, then set state to 2.
</p><p>state 4: if "OK" button (0x0020) pressed then discrease 80083284 (dialog scrolling value) by 2. Increment 801142CC (additional rows) by 1. Set state to 8.
</p><p>state 6: if WMODE cbc &amp; 0x01 not set and "OK" button (0x0020) pressed then set state to 7 and call "dialog_window_discrease".
</p><p>state 7: call "dialog_window_discrease".
</p><p>state 8: call "dialog_scroll_text".
</p><p>state 9: call "dialog_init_next_window".
</p><p>state B: if "OK" button (0x0020) pressed then set state to C.  Discrease 80083284 (dialog scrolling value) by 2. Set 800E424C to current_row * 10 + 11.
</p><p>state C: call "dialog_scroll_text_during_ok".
</p><p>state D: if "OK" button (0x0020) pressed then set state to 2.
</p><p>state E: if "OK" button (0x0020) pressed then call "dialog_init_next_window".
</p><p><br />
</p><p>ask window states:
</p><p>state 0: call "dialog_window_init".
</p><p>state 1: call "dialog_window_growth".
</p><p>state 2: call "dialog_copy_text_from_field".
</p><p>state 3: discrease 8011445C (wait time) by 1 each call. When wait time == 0, then set state to 2.
</p><p>state 4: if "OK" button (0x0020) pressed then discrease 80083284 (dialog scrolling value) by 2. Increment 801142CC (additional rows) by 1. Set state to 8.
</p><p>state 6: if WMODE cbc &amp; 0x01 not set then set (8008328E) enable pointer to 1.
</p>
<pre>        if WMODE cbc &amp; 0x01 not set and "UP" button (0x1000) pressed and first row less then current row then discrease current row by 1 and call "play_window_pointer_click_sound".
        if WMODE cbc &amp; 0x01 not set and "DOWN" button (0x4000) pressed and currewnt row less then last row then increase current row by 1 and call "play_window_pointer_click_sound".
        if WMODE cbc &amp; 0x01 not set then set (80083298) pointex X to 5 and (8008329A) pointer Y to current_row * 10 + 6.
        if WMODE cbc &amp; 0x01 not set and "OK" button (0x0020) pressed then set state to 7 and call "play_window_pointer_click_sound" and "dialog_window_discrease".
</pre>
<p>state 7: call "dialog_window_discrease".
</p>
<pre>        if window is still closing invert (8008328E) enable pointer to make it blink.
        when window closed set (8008328E) enable pointer to 0.
</pre>
<p>state 8: call "dialog_scroll_text".
</p><p>state 9: call "dialog_init_next_window".
</p><p>state B: if "OK" button (0x0020) pressed then set state to C.  Discrease 80083284 (dialog scrolling value) by 2. Set 800E424C to current_row * 10 + 11.
</p><p>state C: call "dialog_scroll_text_during_ok".
</p><p>state D: if "OK" button (0x0020) pressed then set state to 2.
</p><p>state E: if "OK" button (0x0020) pressed then call "dialog_init_next_window".
</p><p><br />
</p><p>state cycle
0-&gt;1-&gt;2
</p><p>2-&gt;0xE7-&gt;4-&gt;8-&gt;2
</p><p>2-&gt;0xE8-&gt;E-&gt;2
</p><p>2-&gt;0xE9-&gt;E-&gt;2
</p><p>2-&gt;0xFEDC-&gt;D-&gt;2
</p><p>2-&gt;0xFEDD-&gt;3-&gt;2
</p><p>2-&gt;0xFEE0-&gt;B-&gt;C-&gt;9-&gt;2
</p><p>2-&gt;0xFEFF-&gt;D-&gt;2
</p><p>2-&gt;0xFF-&gt;6-&gt;7-&gt;0
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Functions"> Functions </span></h2>
<p>dialog_copy_text_from_field:
</p>
<pre>   First we set reading parameters.
   If 800832A2 (cbc) 0x02 bit is set then A1 = 0x100, S5 = 1. This will cause all characters show at once.
   If 800832A2 (cbc) 0x02 bit is not set then we check if "OK" button (0x0020) pressed. If yes we increment 80114480 by 1 (but no more than 80), if not - decrement by 1 (no less than 1).
   If 800832A2 (cbc) 0x02 bit is not set and message speed &lt; 0x80 then we set A1 = ((80 - message speed) / 32) + 2. S5 = 1.
   If 800832A2 (cbc) 0x02 bit is not set and message speed &gt;= 0x80 then we set A1 = 2. S5 = ((message speed - 80) / 32) + 1.
   Now we use A1, S5, 80114480 and 80114470 to calculate 80114470 value which will be used to calculate if we must continue reading characters or not. 80114470 = 80114470 + S5 * 80114480 / 10 + A1.
   Now we will read characters until 80114470 &lt;= S5 if so - end string copy until next call.
</pre>
<p><br />
dialog_window_init:
</p>
<pre>   Do check if pointer to field dialog section not 0 (call "funcd4848" if it zero and return 1 (stop MESSAGE or ASK opcode)).
   Set parent entity to this window.
   Set current_width to width / 4, but no less than 8.
   Set current_height to height / 4, but no less than 8.
   Set 80083274 to pointer to window string.
   Set 80083284 to 0.
   Set 80083286 to 0 (letters in window string).
   Set 80083288 to 0 (bytes in window string).
   Set 8008328A to 0.
   Set 8008328E to 0.
   Set state to 1.
   Set 800E4234 as pointer to field string.
   Set 80114278 to 0 (name reading offset).
   Set 80114280 to 0 (current variable).
   Set 801142CC to 0.
   Set 80114470 to 0.
   Set 80114480 to 1.
   Set 8011451C to -1 (current variable reading offset).
   Increment 80071E2C (opened windows number) by 1;
   Write 0xFF at start of window string.
</pre>
<p>dialog_window_growth:
</p>
<pre>   Increment current_width by width / 4, but current_width no less than 8 and no more than width.
   Increment current_height by height / 4, but current_height no less than 8 and no more than height.
   If current_width == width and current_height == height then set state to 1.
</pre>
<p>dialog_window_discrease:
</p>
<pre>   Decrement current_width by width / 4, but current_width no less than 8.
   Decrement current_height by height / 4, but current_height no less than 8.
   If current_width  &lt;= 8 and current_height &lt;= 8 then set state to 0. Set 80083286 (letters in window string) to 0. Remove parent entity from this window (set to FF).
   Decrement 80071E2C (opened windows number) by 1;
</pre>
<p>dialog_init_next_window:
</p>
<pre>   Set 80083284 to 0.
   Set 80083286 to 0.
   Set 80083288 to 0.
   Set 8008328A to 0.
   Set 800832A0 to 2 (state).
   Set 801142CC to 0.
   Set 80114480 to 1.
   Write 0xFF at start of window string.
</pre>
<p>dialog_copy_text_from_field:
</p>
<pre>   Copy text from field to window string. Set state to 6 when tork normally. Can set other state according to readed opcodes.
</pre>
<p>dialog_scroll_text:
</p>
<pre>   Discrease 80083284 (dialog scrolling value) by 2 each time called.
   If discreased by 0x10 (X &amp; 0x0F == false) - set state to 2 and copy new part of string.
</pre>
<p>dialog_scroll_text_during_ok:
</p>
<pre>   Discrease 80083284 (dialog scrolling value) by 80114480 / 4 each time called and "OK" button (0x0020) pressed.
   Increase 80114480 by 1 each time "OK" button (0x0020) pressed.
   Discrease 80114480 by 1 each time "OK" button (0x0020) not pressed.
   If 800E424C (total width value) + 80083284 (text scrolling value) less than zero set state to 9.
</pre>
<p>set_window_x_y_width_height:
</p>
<pre>   Writes data to window structure.
   Set x_position to given x. X no less than 8. If x + width &gt; 0x138 then set x to 138 - width.
   Set y_position to given y. Y no less than 8. If y + height &gt; 0xE0 then set x to E0 - height.
   Set width to given width.
   Set height to given height.
</pre>
<p>set_window_style_cbc:
</p>
<pre>   Writes data to window structure.
   Set WMODE_style to given stype.
   Set WMODE_cbc to given cbc.
</pre>
<p>set_state_to_close:
</p>
<pre>   If state == 1 return 0;
   If state 0 or 3 or 5 or 7 or 9 or A or C or E return 1;
   Id state 2 or 4 or 6 or 8 or B or D set state to 7 and then return 1;
</pre>
<p>add_x_y_to_window_position:
</p>
<pre>   Writes data to window structure.
   Add given x to x_position.
   Add given y to y_position.
</pre>
<p>reset_window:
</p>
<pre>   Writes data to window structure.
   Set x_position to 0x08.
   Set y_position to 0x08 if we reset window with id == 1, set to 0x95 otherwise.
   Set width to 0x139;
   Set height to 0x49;
   Set current_width to 1;
   Set current_height to 1;
   Set state to 0;
   Set WMODE_style to 0;
   Set WSPCL_type to 0.
   Set 80083290 to 0.
   Set WNUMB number of digits in number to 6.
   Set WSPCL_x to 0.
   Set WSPCL_y to 0.
   Set WMODE_cbc to 0.
   Set windows parent entity to -1 (0xFF).
   Clear 800E4214 (memory bank array for getting variable for windows) array with 0.
   Clear 800E4D48 (offsets for getting variable from memory block for windows) array with 0.
   Set 8011445C (time to wait for windows) to 0.
</pre>
<p>set_window_height:
</p>
<pre>   Writes data to window structure.
   Set height to given height value.
</pre>
<p><br />
</p>
<h2> <span class="mw-headline" id="Opcodes"> Opcodes </span></h2>
<p>0x2E WCLS
</p>
<pre>   [0x2E][window_id]
   If window opened call "set_state_to_close" and then "manage_window_states" to close window.
   This opcode called until window closed (we can call this opcode from any entity).
</pre>
<p>0x2F WSIZW
</p>
<pre>   [0x2F][window_id][ [x] ][ [y] ][ [width] ][ [height] ]
   If window not opened yet - call "WINDOW" opcode which set parameters and continue script execution.
   If window opened and parent entity the same as current entity call "set_state_to_close" and then "manage_window_states" to close window.
   This opcode called until window closed (if we try to call this opcode from other entity this opcode will wait until window closed).
</pre>
<p>0x36 WSPCL
</p>
<pre>   [0x36][window_id][type][x][y]
   Writes type to WSPCL_type in window structure.
   Writes x to WSPCL_x in window structure.
   Writes y to WSPCL_y in window structure.
   In field files only type 00 01 and 02 used.
</pre>
<p>0x37 WNUMB
</p>
<pre>   [0x37][bank_for_number_lower_part/bank_for_number_upper_part][window_id][ [number_lower_part] ][ [number_upper_part] ][number_of_digits]
   Writes number to WNUMB_number in window structure (construct from upper and lower parts).
   Writes number_of_digits to WNUMB_number_of_digits in window structure.
</pre>
<p>0x38 STTIM
</p>
<pre>   [0x38][bank_for_hours/bank_for_minutes][0/bank_for_seconds][hours][minutes][seconds]
   Writes seconds value to 8009D268 (savemap) as hours * 3600 + minutes * 60 + seconds.
</pre>
<p>0x40 MESSAGE
</p>
<pre>   [0x40][window_id][dialog_id]
   Call "manage_window_states" which sets window_id and dialog_id, handle window states and do many other things.
   This opcode called until window closed.
</pre>
<p>0x41 MPARA
</p>
<pre>   [0x41][bank_for_variable_id/bank_for_value][window_id][variable_id][value]
   Writes bank_for_value to 800E4214 memory bank variable array (size 0x08 0x01). This value will be used when we will copy field dialog to window string.
   Writes value to 800E4D48 offsets for variable array (size 0x10 0x02). This value will be used when we will copy field dialog to window string.
</pre>
<p>0x42 MPRA2
</p>
<pre>   [0x42][bank_for_variable_id/bank_for_value][window_id][variable_id][ [value] ]
   Writes bank_for_value to 800E4214 memory bank variable array (size 0x08 0x01). This value will be used when we will copy field dialog to window string.
   Writes value to 800E4D48 offsets for variable array (size 0x10 0x02). This value will be used when we will copy field dialog to window string.
</pre>
<p>0x48 ASK
</p>
<pre>   [0x48][0/bank_for_pointer_row][window_id][dialog_id][first][last][offset_for_pointer_row]
   Call "manage_ask_window_states" which sets window_id and dialog_id, handle ask window states and do many other things.
   Stores current pointer row to given bank_for_pointer_row + offset_for_pointer_row.
   Set 8009ABF4 + 32 (UC) to game data.
   This opcode called until window closed.
   When window closed restore character movement from 80081DC4 (current UP opcode state).
</pre>
<p>0x50 WINDOW
</p>
<pre>   [0x50][window_id][ [x] ][ [y] ][ [width] ][ [height] ]
   Call "set_window_x_y_width_height" which sets parameters to window structure.
</pre>
<p>0x51 WMOVE
</p>
<pre>   [0x51][window_id][ [x] ][ [y] ]
   Call "add_x_y_to_window_position" which adds x and y to current values in window structure.
</pre>
<p>0x52 WMODE
</p>
<pre>   [0x52][window_id][style][cbc]
   Call "set_window_style_cbc" which sets  parameters to window structure.
   In field files only cbc 00 and 01 used. But there are check on 02 during "dialog_copy_text_from_field" function.
   In field files only style 00, 01 and 02 used.
</pre>
<p>0x53 WREST
</p>
<pre>   [0x53][window_id]
   Call "reset_window" which sets default values to window structure and some additional arrays.
</pre>
<p>0x54 WCLSE
</p>
<pre>   [0x54][window_id]
   Call "set_state_to_close" and if it returns 1 - continue script execution.
   Opcode tries to set window to close. if it can't - continue execution. this opcode will called again only if window is opening (state 1). It will wait till it completly opened.
   Window will not actually closed by itself. MESSAGE or ASK opcode must handle actual process.
</pre>
<p>0x55 WROW
</p>
<pre>   [0x55][window_id][rows]
   Call "set_window_height" with height value as (rows * 0x10) + 9
</pre>
<p>0x56 GWCOL
</p>
<pre>   [0x56][bank_for_corner/bank_for_r][bank_for_g/bank_for_b][corner][r][g][b]
   Store 80049208 (red value of given corner) in bank_for_r + r.
   Store 80049209 (green value of given corner) in bank_for_g + g.
   Store 8004920A (blue value of given corner) in bank_for_b + b.
</pre>
<p>0x57 SWCOL
</p>
<pre>   [0x57][bank_for_corner/bank_for_r][bank_for_g/bank_for_b][corner][r][g][b]
   Set 80049208 (red value of given corner) to bank_for_r + r.
   Set 80049209 (green value of given corner) to bank_for_g + g.
   Set 8004920A (blue value of given corner) in bank_for_b + b.
</pre>
<p><br />
</p>
<h2> <span class="mw-headline" id="Special_Letters"> Special Letters </span></h2>
<p>field copy:
</p><p>XX - for any usual letter we inctement letter and byte data by 1.
</p><p>E0 - tabulation. Writes 0xA spaces(0x00) to string data. Increment letters and bytes data by 0xA.
</p><p>E1 - tabulation. Writes 0x4 spaces(0x00) to string data. Increment letters and bytes data by 0x4.
</p><p>E2 - writes 0x0C, 0x00(, ) Increment letters and bytes data by 0x2.
</p><p>E3 - writes 0x0E, 0x02(.") Increment letters and bytes data by 0x2.
</p><p>E4 - writes 0xA9, 0x02(...") Increment letters and bytes data by 0x2.
</p><p>E5 - usual letter.
</p><p>E6 - usual letter.
</p><p>E7 - next row.
</p>
<pre>       If row number equal to max row number - write FF to string. Set window state to 0x4. Write 0 to 80114470 array. Write 1 to 80114480 array.
       If row numbet less then max row number - write E7 to string. Increment byte and row data by 1.
</pre>
<p>E8 - next window. Set window state to 0xE. End string copying. Write FF to string. Write 0x0000 to 80114470 array. Write 0x0001 to 80114480 array.
</p><p>E9 - next window. Set window state to 0xE. End string copying. Write FF to string. Write 0x0000 to 80114470 array. Write 0x0001 to 80114480 array.
</p><p>EA - character name from savemap 0x00 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>EB - character name from savemap 0x01 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>EC - character name from savemap 0x02 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>ED - character name from savemap 0x03 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>EE - character name from savemap 0x04 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>EF - character name from savemap 0x05 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F0 - character name from savemap 0x06 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F1 - character name from savemap 0x07 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F2 - character name from savemap 0x08 character data. Copy 9 bytes or until encount FF. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F3 - party character name. Get character id from 0x0CAE party data in savemap and load character name from savemap data. Copy 9 bytes or until encount FF. If party character 0xFF (none) - write 0xA9(...) 9 times. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F4 - party character name. Get character id from 0x0CAF party data in savemap and load character name from savemap data. Copy 9 bytes or until encount FF. If party character 0xFF (none) - write 0xA9(...) 9 times. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F5 - party character name. Get character id from 0x0CB0 party data in savemap and load character name from savemap data. Copy 9 bytes or until encount FF. If party character 0xFF (none) - write 0xA9(...) 9 times. Increment letters and byte data by 1 for each copying byte. Descrease 80114470 by S5 for each copying byte.
</p><p>F6 - usual letter.
</p><p>F7 - usual letter.
</p><p>F8 - usual letter.
</p><p>F9 - usual letter.
</p><p>FA - copied to string together with next byte. Increment letters data by 1 and byte data by 2. Used in the Japanese version to print special characters from the extended font. The sequence 0xFA00 translates to screen as '&#24517;'.
</p><p>FB - copied to string together with next byte. Increment letters data by 1 and byte data by 2. Used in the Japanese version to print special characters from the extended font. The sequence 0xFB00 translates to screen as '&#23433;'.
</p><p>FC - copied to string together with next byte. Increment letters data by 1 and byte data by 2. Used in the Japanese version to print special characters from the extended font. The sequence 0xFC00 translates to screen as '&#30001;'.
</p><p>FD - copied to string together with next byte. Increment letters data by 1 and byte data by 2. Used in the Japanese version to print special characters from the extended font. The sequence 0xFD00 translates to screen as '&#21451;'.
</p><p>FE - special opcode. Write FE to string. Increment byte data by 1. Read next byte and do something according to it. Case 00-D1 are used in the Japanese version to print special characters from the extended font. The sequence 0xFE00 translates to screen as '&#23403;'.
</p><p>FED2 - increment byte data by 1. Write this byte to string. (colour formater: Gray)
</p><p>FED3 - increment byte data by 1. Write this byte to string. (colour formater: Blue)
</p><p>FED4 - increment byte data by 1. Write this byte to string. (colour formater: Red)
</p><p>FED5 - increment byte data by 1. Write this byte to string. (colour formater: Purple)
</p><p>FED6 - increment byte data by 1. Write this byte to string. (colour formater: Green)
</p><p>FED7 - increment byte data by 1. Write this byte to string. (colour formater: Cyan)
</p><p>FED8 - increment byte data by 1. Write this byte to string. (colour formater: Yellow)
</p><p>FED9 - increment byte data by 1. Write this byte to string. (colour formater: White)
</p><p>FEDA - increment byte data by 1. Write this byte to string. (colour formater: Flash)
</p><p>FEDB - increment byte data by 1. Write this byte to string. (colour formater: Rainbow)
</p><p>FEDC - remove FE from string by decrement byte data by 1. Set window state to 0xD. Write 0x0000 to 80114470 array. Write 0x0001 to 80114480 array. End string copying. Write FF to string.
</p><p>FEDD - set window state to 0x3. Copy next byte and byte after it to 8011445C array (swapped). Increment byte data by 3 (similar to write 000000). Write FF to string. End string copying.
</p><p>FEDE - remove FE from string by decrement byte data by 1. Get 1 or 2 byte value from memory bank. Convert that digit to string without preceding zeros (with ending FF). Copy 0x10 bytes (or until we met FF) of given string to window string incrementing byte and letter data by 1 for each byte. Descrease 80114470 by S5 for each copying byte. There can be 8 variable in one window (for all variable opcodes DE DF E1).
</p><p>FEDF - remove FE from string by decrement byte data by 1. Get 1 or 2 byte value from memory bank. Convert that digit to string as hex without preceding zeros (with ending FF). Copy 0x10 bytes (or until we met FF) of given string to window string incrementing byte and letter data by 1 for each byte. Descrease 80114470 by S5 for each copying byte. There can be 8 variable in one window (for all variable opcodes DE DF E1).
</p><p>FEE0 - remove FE from string by decrement byte data by 1. Set window state to 0xB. Write 0x0000 to 80114470 array. Write 0x0001 to 80114480 array. End string copying. Write FF to string.
</p><p>FEE1 - remove FE from string by decrement byte data by 1. Get 1 or 2 byte value from memory bank. Convert that digit to string replacing preceding zeros with space (0x00) (with ending FF). Copy 0x10 bytes (or until we met FF) of given string to window string incrementing byte and letter data by 1 for each byte. Descrease 80114470 by S5 for each copying byte. There can be 8 variable in one window (for all variable opcodes DE DF E1).
</p><p>FEE2 - remove FE from string by decrement byte data by 1. Get 3-4 byte as offset and 5-6 byte as length. Copy length bytes from memory block 1/2 offset + offset to temp string (end string with 0xFF). Copy bytes from temp string to winfow string until we met FF, incrementing byte and letter data by 1 for each byte. Descrease 80114470 by S5 for each copying byte.
</p><p>FEE3 - usual letter.
</p><p>FEE4 - usual letter.
</p><p>FEE5 - usual letter.
</p><p>FEE6 - usual letter.
</p><p>FEE7 - usual letter.
</p><p>FEE8 - usual letter.
</p><p>FEE9 - increment byte data by 1. Write this byte to string. (max letter width formater)
</p><p>FEEA - unused (messed addres)
</p><p>FEEB - unused (messed addres)
</p><p>FEEC - unused (messed addres)
</p><p>FEED - unused (messed addres)
</p><p>FEEE - unused (messed addres)
</p><p>FEEF - unused (messed addres)
</p><p>FEF0 - unused (messed addres)
</p><p>FEF1 - unused (messed addres)
</p><p>FEF2 - unused (messed addres)
</p><p>FEF3 - unused (messed addres)
</p><p>FEF4 - unused (messed addres)
</p><p>FEF5 - unused (messed addres)
</p><p>FEF6 - unused (messed addres)
</p><p>FEF7 - unused (messed addres)
</p><p>FEF8 - unused (messed addres)
</p><p>FEF9 - unused (messed addres)
</p><p>FEFA - unused (messed addres)
</p><p>FEFB - unused (messed addres)
</p><p>FEFC - unused (messed addres)
</p><p>FEFD - unused (messed addres)
</p><p>FEFE - unused (messed addres)
</p><p>FEFF - remove FE from string by decrement byte data by 1. Set window state to 0xD. Write 0x0000 to 80114470 array. Write 0x0001 to 80114480 array. End string copying. Write FF to string.
</p><p>FF - end string copying. Write FF to string. Set window state to 0x6. Write 0x0000 to 80114470 array.
</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 22/1000000
Preprocessor generated node count: 28/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key qhimm_wiki:pcache:idhash:1335-0!*!*!!en!*!* and timestamp 20160922123839 -->
</div>				<!-- /bodycontent -->
								<!-- printfooter -->
				<div class="printfooter">
				Retrieved from "<a href="http://wiki.qhimm.com/index.php?title=FF7/Field/DialogWindow&amp;oldid=4169">http://wiki.qhimm.com/index.php?title=FF7/Field/DialogWindow&amp;oldid=4169</a>"				</div>
				<!-- /printfooter -->
												<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
				<!-- debughtml -->
								<!-- /debughtml -->
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Personal tools</h5>
	<ul>
		<li id="pt-login"><a href="http://wiki.qhimm.com/index.php?title=Special:UserLogin&amp;returnto=FF7%2FField%2FDialogWindow" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
	</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Namespaces</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="DialogWindow.html"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://wiki.qhimm.com/edit/Talk:FF7/Field/DialogWindow?redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
	<h4>
		</h4>
	<h5><span>Variants</span><a href="DialogWindow.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Views</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="DialogWindow.html" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="http://wiki.qhimm.com/edit/FF7/Field/DialogWindow"  title="This page is protected.&#13;&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="http://wiki.qhimm.com/history/FF7/Field/DialogWindow"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Actions</span><a href="DialogWindow.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Search</label></h5>
	<form action="http://wiki.qhimm.com/index.php" id="searchform">
				<div>
			<input type="search" name="search" title="Search QhimmWiki [f]" accesskey="f" id="searchInput" />			<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />			<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />					<input type='hidden' name="title" value="Special:Search"/>
		</div>
	</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../../skins/wiki.png);" href="../../Main_Page.html"  title="Visit the main page"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Navigation</h5>
	<div class="body">
		<ul>
			<li id="n-mainpage-description"><a href="../../Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
			<li id="n-portal"><a href="http://wiki.qhimm.com/view/QhimmWiki:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
			<li id="n-currentevents"><a href="http://wiki.qhimm.com/view/QhimmWiki:Current_events" title="Find background information on current events">Current events</a></li>
			<li id="n-recentchanges"><a href="../../Special%253ARecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
			<li id="n-randompage"><a href="../../Special%253ARandom.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
			<li id="n-help"><a href="../../Help%253AContents.html" title="The place to find out">Help</a></li>
		</ul>
	</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id='p-tb'>
	<h5>Toolbox</h5>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="../../Special%253AWhatLinksHere/FF7/Field/DialogWindow.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="../../Special%253ARecentChangesLinked/FF7/Field/DialogWindow.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="../../Special%253ASpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="http://wiki.qhimm.com/index.php?title=FF7/Field/DialogWindow&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="http://wiki.qhimm.com/index.php?title=FF7/Field/DialogWindow&amp;oldid=4169" title="Permanent link to this revision of the page">Permanent link</a></li>
		</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 7 May 2013, at 18:13.</li>
											<li id="footer-info-viewcount">This page has been accessed 5,899 times.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" href="http://creativecommons.org/licenses/by-nc-sa/2.5/">Attribution-NonCommercial-ShareAlike</a>.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="http://wiki.qhimm.com/view/QhimmWiki:Privacy_policy" title="QhimmWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="http://wiki.qhimm.com/view/QhimmWiki:About" title="QhimmWiki:About">About QhimmWiki</a></li>
											<li id="footer-places-disclaimer"><a href="../../QhimmWiki%253AGeneral_disclaimer.html" title="QhimmWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-nc-sa/2.5/"><img src="http://creativecommons.org/images/public/somerights20.gif" alt="Attribution-NonCommercial-ShareAlike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../../../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script src="../../../load.php@debug=false&amp;lang=en&amp;modules=skins.vector&amp;only=scripts&amp;skin=vector&amp;%252A"></script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<!-- Served in 0.111 secs. -->
	</body>
</html>
